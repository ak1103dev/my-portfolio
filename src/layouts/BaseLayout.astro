---
// src/layouts/BaseLayout.astro
import { getLangFromUrl } from '../i18n/utils';
export interface Props {
	title: string;
}

const { title } = Astro.props;
const lang = getLangFromUrl(Astro.url);
---
<!DOCTYPE html>
<html lang={lang}>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>

    <!-- Google Fonts: Inter (sans-serif) & Fira Code (monospace) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Fira+Code:wght@500&display=swap" rel="stylesheet">

    <!-- Theme Switcher Script -->
    <script is:inline>
        // This script is executed on the client to determine the theme before rendering.
        // It checks local storage first, then system preference.
        const theme = (() => {
            if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
                return localStorage.getItem('theme');
            }
            if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                return 'dark';
            }
            return 'light';
        })();

        if (theme === 'dark') {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }

        // Set the global window.theme property for other scripts to access
        window.localStorage.setItem('theme', theme);
    </script>
</head>
<body class="bg-white dark:bg-charcoal text-primary-text-light dark:text-primary-text-dark font-sans selection:bg-accent selection:text-white">
    <slot />
</body>
</html>

<style is:global>
    /* 
     * We define the CSS variables here based on the design system.
     * Tailwind's JIT compiler will pick these up.
     */
    :root {
        --color-primary-text-light: #1A1A1A;
        --color-background-light: #FFFFFF;
        --color-accent-light: #1F3A8A;
        
        --color-primary-text-dark: #F7F7F7;
        --color-background-dark: #121212;
        --color-accent-dark: #4A85E7;
    }

    /* Apply styles for light mode (default) */
    html:not(.dark) {
        --color-primary-text: var(--color-primary-text-light);
        --color-background: var(--color-background-light);
        --color-accent: var(--color-accent-light);
    }

    /* Apply styles for dark mode */
    html.dark {
        --color-primary-text: var(--color-primary-text-dark);
        --color-background: var(--color-background-dark);
        --color-accent: var(--color-accent-dark);
    }
</style>
