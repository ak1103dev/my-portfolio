---
// src/components/Projects.astro
import Modal from "./Modal.astro";
import { useTranslations, type Language } from "../i18n/utils";

export interface Props {
    lang: Language;
}

const { lang } = Astro.props;
const t = useTranslations(lang);

const projects = [
    {
        id: "project-1",
        title: t("projects.project1.title"),
        summary: t("projects.project1.summary"),
        details: t("projects.project1.details"),
    },
];
---

<section id="projects" class="py-20 px-4">
    <div class="max-w-7xl mx-auto">
        <h2
            class="text-4xl md:text-5xl font-bold mb-12 text-center text-primary-text-light dark:text-primary-text-dark"
        >
            {t("projects.title")}
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {
                projects.map((project) => (
                    <div class="bg-white dark:bg-charcoal/50 rounded-lg shadow-lg p-8 flex flex-col border border-gray-200 dark:border-gray-700">
                        <h3 class="text-2xl font-bold mb-4 text-accent dark:text-accent-dark">
                            {project.title}
                        </h3>
                        <p class="text-primary-text-light/80 dark:text-primary-text-dark/80 flex-grow">
                            {project.summary}
                        </p>
                        <button
                            data-modal-target={project.id}
                            class="mt-6 self-start bg-accent dark:bg-accent-dark text-white font-bold py-2 px-6 rounded-full hover:bg-opacity-90 dark:hover:bg-opacity-90 transition-all"
                        >
                            {t("projects.readMore")}
                        </button>
                    </div>
                ))
            }
        </div>
    </div>
</section>

<Modal>
    <div id="modal-project-details">
        <!-- Project details will be injected here by JavaScript -->
    </div>
</Modal>

<script define:vars={{ projects }}>
    const modalBackdrop = document.getElementById("modal-backdrop");
    const modalDetailsContainer = document.getElementById(
        "modal-project-details",
    );
    const readMoreButtons = document.querySelectorAll("[data-modal-target]");

    readMoreButtons.forEach((button) => {
        button.addEventListener("click", () => {
            const projectId = button.getAttribute("data-modal-target");
            const project = projects.find((p) => p.id === projectId);

            if (project) {
                modalDetailsContainer.innerHTML = project.details;
                modalBackdrop.classList.remove("hidden");
                document.body.style.overflow = "hidden"; // Prevent scrolling
            }
        });
    });
</script>
